---
title: pytorch 직접 데이터 로더 만들고 이미지 학습시키기 
tags: pytorch, 파이토치, dataloader
---
## Dataloader의 필요성
파이토치 튜톨리얼을 따라하면서 딥러닝을 배우다보면 기본적으로 데이터 셋이 모두 준비되어있어 따라하기만 하면 학습을 진행 할 수 있다. 하지만 우리가 딥러닝을 배우고자 했던 목표는 자신의 이미지를 가지고 학습 시켜 자신의 프로젝트를 진행하는 것 이였을 것이다. 이를 위해서 알아야 하는게 dataloader다.
  
이 포스트에서는 pytorch [cifar10 튜톨리얼](https://pytorch.org/tutorials/beginner/blitz/cifar10_tutorial.html)을 응용해서 직접 cifar10 데이터를 로드하고, 학습시켜 본다. 

---

## 대략적인 구조
우리가 학습하고자 하는 데이터 셋에 대해 Dataset 클래스로 정의한뒤, Dataloader 클래스에 인수로 주면 network에서 우리의 데이터를 사용할 수 있다. 간단하게 Dataset 클래스와 Dataloader에 대해 알아보자.

## Dataset
Dataset 클래스의 기본적인 구조는 다음과 같다.
```python
class My_mnist_set(Dataset):

    def __init__(self):
    # 인자를 받아 인스턴스 변수를 초기화 

    def __len__(self):
    # 데이터 셋의 길이를 리턴한다.
        return len()

    def __getitem__(self):
    # 학습 이미지와 이미지의 GT (cifar10이므로 이미지의 class)를 리턴한다.
        return image, classes
```
Dataset은 크게 3가지 메소드를 정의한다.
### `__init__`  
일반적인 클래스에서의 사용법과 동일하다.클래스에서 사용할 인자를 받아 인스턴스 변수로 저장하는 일을 한다. 예를들면, 이미지의 경로 리스트를 저장하는 일을 하게 된다.
### `__len__`
데이터 셋의 길이를 정수로 반환한다. cifar10의 경우 트레이닝, 혹은 테스트 셋의 전체 이미지의 갯수가 될 것이다.
### `__getitem__` 
실제 이미지 파일과 해당이미지의 GT(ground truth) 값을 반환한다. cifar10의 경우 해당이미지가 고양이인지, 배인지, 사슴인지 등을 담은 class를 리턴하게 된다.

## Dataloader
pytorch 문서에서 [torch.utils.data.DataLoader](https://pytorch.org/docs/stable/data.html)를 찾아보면 다음과 같이 나온다.
```python
DataLoader(dataset, batch_size=1, shuffle=False, sampler=None,
           batch_sampler=None, num_workers=0, collate_fn=None,
           pin_memory=False, drop_last=False, timeout=0,
           worker_init_fn=None)
```
당장 필요한것만 설명하면 다음과 같다.
* dataset : 데이터에 대해 명세한 dataset 클래스 객체를 넣으면 된다.
* batch_size : 배치 사이즈는 minibatch를 말한다. 그래픽카드의 메모리에 따라 적절한 값을 지정한다. 클수록 메모리에 한번에 많은 이미지를 올려 학습시키기 때문에 학습 속도가 빨라진다. 하지만 이번엔 4 정도로 할것이다.
* shuffle : 이미지를 섞어서 학습할지 지정한다. True로 지정해 섞어서 학습하는 편이 좋다.

---

## 작성중

## cifar 10 파일 가져오기

### glob

## Dataset 정의하기

### `__init__`
### `__len__`
### `__getitem__`

## Dataloader